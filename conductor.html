<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Perfil del Conductor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial;
  background:#f4f6f8;
  padding:20px;
}

.card{
  max-width:700px;
  margin:auto;
  background:white;
  padding:25px;
  border-radius:12px;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
}

.campo{
  margin-bottom:8px;
}

.estado{
  font-weight:bold;
  padding:6px 10px;
  border-radius:6px;
  display:inline-block;
}

.activo{ background:#d4edda; color:#155724; }
.inactivo{ background:#f8d7da; color:#721c24; }

.queja{
  border-top:1px solid #ccc;
  padding:8px 0;
}
</style>
</head>
<body>

<div class="card">
<h2 style="text-align:center;">Perfil del Conductor</h2>
<div id="contenido">Cargando...</div>
</div>

<script>

const API = "https://conductores-api.onrender.com";
const id = new URLSearchParams(window.location.search).get("id");

async function cargar(){

  if(!id){
    contenido.innerHTML = "ID no válido";
    return;
  }

  try{

    const res = await fetch(`${API}/api/conductores/${id}`);
    if(!res.ok) throw new Error();

    const data = await res.json();
    const c = data.conductor;
    const q = data.quejas || [];

    contenido.innerHTML = `
      <div class="campo"><strong>Nombre:</strong> ${c.nombres} ${c.apellidos}</div>
      <div class="campo"><strong>Cédula:</strong> ${c.cedula}</div>
      <div class="campo"><strong>Licencia:</strong> ${c.licencia}</div>
      <div class="campo"><strong>Estado:</strong> 
        <span class="estado ${c.estado === 'ACTIVO' ? 'activo':'inactivo'}">
        ${c.estado}
        </span>
      </div>

      <h3>Historial de Reportes</h3>
      ${q.length === 0 ? "Sin reportes." :
        q.map(x=>`
          <div class="queja">
            <strong>${new Date(x.fecha).toLocaleDateString()}</strong><br>
            ${x.descripcion} (${x.estado})
          </div>
        `).join("")
      }
    `;

  }catch{
    contenido.innerHTML = "Error cargando datos.";
  }
}

cargar();

</script>
</body>
</html>